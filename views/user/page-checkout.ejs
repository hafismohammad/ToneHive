<!DOCTYPE html>
<html class="no-js" lang="en">
  <!-- Mirrored from wp.alithemes.com/html/evara/evara-frontend/index-4.html by HTTrack Website Copier/3.x [XR&CO'2014], Sat, 15 Jul 2023 10:10:09 GMT -->

  <head>
    <meta charset="utf-8" />
    <title>Tone Hive</title>
    <meta http-equiv="x-ua-compatible" content="ie=edge" />
    <meta name="description" content="" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta property="og:title" content="" />
    <meta property="og:type" content="" />
    <meta property="og:url" content="" />
    <meta property="og:image" content="" />
    <link
      rel="stylesheet"
      href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css"
    />

    <!-- Favicon -->
    <link
      rel="shortcut icon"
      type="image/x-icon"
      href="/public/assets/imgs/theme/Tonehive (1).png"
    />
    <!-- Template CSS -->
    <link rel="stylesheet" href="assets/css/maind134.css?v=3.4" />
    <script src="https://checkout.razorpay.com/v1/checkout.js"></script>
  </head>

  <body>
    <script src="https://cdn.jsdelivr.net/npm/toastify-js"></script>

    <% if (message) { %>
    <script>
      // Display error message using Toastify
      Toastify({
        text: "<%= message %>",
        duration: 5000, // Display duration in milliseconds
        gravity: "top",
        position: "center", // Display position: top, bottom, or middle
        backgroundColor: "#ff3333", // Error message background color
        stopOnFocus: true, // Stop the timer when the toast is focused
      }).showToast();
      const newUrl = window.location.pathname;
      console.log(newUrl); // Get the current path without query parameters
      window.history.replaceState({}, document.title, newUrl);
    </script>
    <% } %> <% if (success) { %>
    <script>
      // Display error message using Toastify
      Toastify({
        text: "<%= success %>",
        duration: 5000, // Display duration in milliseconds
        gravity: "top",
        position: "center", // Display position: top, bottom, or middle
        backgroundColor: "#5cb85c", // Error message background color
        stopOnFocus: true, // Stop the timer when the toast is focused
      }).showToast();
      const newUrls = window.location.pathname; // Get the current path without query parameters
      window.history.replaceState({}, document.title, newUrls);
    </script>
    <% } %>

    <!-- Quick view -->
    <div
      class="modal fade custom-modal"
      id="quickViewModal"
      tabindex="-1"
      aria-labelledby="quickViewModalLabel"
      aria-hidden="true"
    >
      <div class="modal-dialog">
        <div class="modal-content">
          <button
            type="button"
            class="btn-close"
            data-bs-dismiss="modal"
            aria-label="Close"
          ></button>
          <div class="modal-body">
            <div class="row">
              <div class="col-md-6 col-sm-12 col-xs-12">
                <div class="detail-gallery">
                  <span class="zoom-icon"><i class="fi-rs-search"></i></span>
                  <!-- MAIN SLIDES -->
                  <div class="product-image-slider">
                    <figure class="border-radius-10">
                      <img
                        src="assets/imgs/shop/product-16-2.jpg"
                        alt="product image"
                      />
                    </figure>
                    <figure class="border-radius-10">
                      <img
                        src="assets/imgs/shop/product-16-1.jpg"
                        alt="product image"
                      />
                    </figure>
                    <figure class="border-radius-10">
                      <img
                        src="assets/imgs/shop/product-16-3.jpg"
                        alt="product image"
                      />
                    </figure>
                    <figure class="border-radius-10">
                      <img
                        src="assets/imgs/shop/product-16-4.jpg"
                        alt="product image"
                      />
                    </figure>
                    <figure class="border-radius-10">
                      <img
                        src="assets/imgs/shop/product-16-5.jpg"
                        alt="product image"
                      />
                    </figure>
                    <figure class="border-radius-10">
                      <img
                        src="assets/imgs/shop/product-16-6.jpg"
                        alt="product image"
                      />
                    </figure>
                    <figure class="border-radius-10">
                      <img
                        src="assets/imgs/shop/product-16-7.jpg"
                        alt="product image"
                      />
                    </figure>
                  </div>
                  <!-- THUMBNAILS -->
                  <div class="slider-nav-thumbnails pl-15 pr-15">
                    <div>
                      <img
                        src="assets/imgs/shop/thumbnail-3.jpg"
                        alt="product image"
                      />
                    </div>
                    <div>
                      <img
                        src="assets/imgs/shop/thumbnail-4.jpg"
                        alt="product image"
                      />
                    </div>
                    <div>
                      <img
                        src="assets/imgs/shop/thumbnail-5.jpg"
                        alt="product image"
                      />
                    </div>
                    <div>
                      <img
                        src="assets/imgs/shop/thumbnail-6.jpg"
                        alt="product image"
                      />
                    </div>
                    <div>
                      <img
                        src="assets/imgs/shop/thumbnail-7.jpg"
                        alt="product image"
                      />
                    </div>
                    <div>
                      <img
                        src="assets/imgs/shop/thumbnail-8.jpg"
                        alt="product image"
                      />
                    </div>
                    <div>
                      <img
                        src="assets/imgs/shop/thumbnail-9.jpg"
                        alt="product image"
                      />
                    </div>
                  </div>
                </div>
                <!-- End Gallery -->
                <div class="social-icons single-share">
                  <ul class="text-grey-5 d-inline-block">
                    <li><strong class="mr-10">Share this:</strong></li>
                    <li class="social-facebook">
                      <a href="#"
                        ><img
                          src="assets/imgs/theme/icons/icon-facebook.svg"
                          alt=""
                      /></a>
                    </li>
                    <li class="social-twitter">
                      <a href="#"
                        ><img
                          src="assets/imgs/theme/icons/icon-twitter.svg"
                          alt=""
                      /></a>
                    </li>
                    <li class="social-instagram">
                      <a href="#"
                        ><img
                          src="assets/imgs/theme/icons/icon-instagram.svg"
                          alt=""
                      /></a>
                    </li>
                    <li class="social-linkedin">
                      <a href="#"
                        ><img
                          src="assets/imgs/theme/icons/icon-pinterest.svg"
                          alt=""
                      /></a>
                    </li>
                  </ul>
                </div>
              </div>
              <div class="col-md-6 col-sm-12 col-xs-12">
                <div class="detail-info">
                  <h3 class="title-detail mt-30">
                    Colorful Pattern Shirts HD450
                  </h3>
                  <div class="product-detail-rating">
                    <div class="pro-details-brand">
                      <span>
                        Brands:
                        <a href="shop-grid-right.html">Bootstrap</a></span
                      >
                    </div>
                    <div class="product-rate-cover text-end">
                      <div class="product-rate d-inline-block">
                        <div class="product-rating" style="width: 90%"></div>
                      </div>
                      <span class="font-small ml-5 text-muted">
                        (25 reviews)</span
                      >
                    </div>
                  </div>
                  <div class="clearfix product-price-cover">
                    <div class="product-price primary-color float-left">
                      <ins><span class="text-brand">$120.00</span></ins>
                      <ins
                        ><span class="old-price font-md ml-15"
                          >$200.00</span
                        ></ins
                      >
                      <span class="save-price font-md color3 ml-15"
                        >25% Off</span
                      >
                    </div>
                  </div>
                  <div class="bt-1 border-color-1 mt-15 mb-15"></div>
                  <div class="short-desc mb-30">
                    <p class="font-sm">
                      Lorem ipsum dolor, sit amet consectetur adipisicing elit.
                      Aliquam rem officia, corrupti reiciendis minima nisi
                      modi,!
                    </p>
                  </div>

                  <div class="attr-detail attr-color mb-15">
                    <strong class="mr-10">Color</strong>
                    <ul class="list-filter color-filter">
                      <li>
                        <a href="#" data-color="Red"
                          ><span class="product-color-red"></span
                        ></a>
                      </li>
                      <li>
                        <a href="#" data-color="Yellow"
                          ><span class="product-color-yellow"></span
                        ></a>
                      </li>
                      <li class="active">
                        <a href="#" data-color="White"
                          ><span class="product-color-white"></span
                        ></a>
                      </li>
                      <li>
                        <a href="#" data-color="Orange"
                          ><span class="product-color-orange"></span
                        ></a>
                      </li>
                      <li>
                        <a href="#" data-color="Cyan"
                          ><span class="product-color-cyan"></span
                        ></a>
                      </li>
                      <li>
                        <a href="#" data-color="Green"
                          ><span class="product-color-green"></span
                        ></a>
                      </li>
                      <li>
                        <a href="#" data-color="Purple"
                          ><span class="product-color-purple"></span
                        ></a>
                      </li>
                    </ul>
                  </div>
                  <div class="attr-detail attr-size">
                    <strong class="mr-10">Size</strong>
                    <ul class="list-filter size-filter font-small">
                      <li><a href="#">S</a></li>
                      <li class="active"><a href="#">M</a></li>
                      <li><a href="#">L</a></li>
                      <li><a href="#">XL</a></li>
                      <li><a href="#">XXL</a></li>
                    </ul>
                  </div>
                  <div class="bt-1 border-color-1 mt-30 mb-30"></div>
                  <div class="detail-extralink">
                    <div class="detail-qty border radius">
                      <a href="#" class="qty-down"
                        ><i class="fi-rs-angle-small-down"></i
                      ></a>
                      <span class="qty-val">1</span>
                      <a href="#" class="qty-up"
                        ><i class="fi-rs-angle-small-up"></i
                      ></a>
                    </div>
                    <div class="product-extra-link2">
                      <button type="submit" class="button button-add-to-cart">
                        Add to cart
                      </button>
                      <a
                        aria-label="Add To Wishlist"
                        class="action-btn hover-up"
                        href="#"
                        ><i class="fi-rs-heart"></i
                      ></a>
                      <a
                        aria-label="Compare"
                        class="action-btn hover-up"
                        href="#"
                        ><i class="fi-rs-shuffle"></i
                      ></a>
                    </div>
                  </div>
                  <ul class="product-meta font-xs color-grey mt-50">
                    <li class="mb-5">SKU: <a href="#">FWM15VKT</a></li>
                    <li class="mb-5">
                      Tags: <a href="#" rel="tag">Cloth</a>,
                      <a href="#" rel="tag">Women</a>,
                      <a href="#" rel="tag">Dress</a>
                    </li>
                    <li>
                      Availability:<span class="in-stock text-success ml-5"
                        >8 Items In Stock</span
                      >
                    </li>
                  </ul>
                </div>
                <!-- Detail Info -->
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
    <%- include('../layouts/user/header-2') %>

    <main class="main mt-30">
      <div class="page-header breadcrumb-wrap">
        <div class="container">
          <div class="breadcrumb">
            <a href="/userHome" rel="nofollow">Home</a>
            <a href="/shop"><span></span> Shop</a>
            <a href="/checkout"><span></span> Checkout</a>
          </div>
        </div>
      </div>
      <section class="mt-50 mb-50">
        <div class="container">
          <div class="col-lg-6">
            <div class="toggle_info">
              <span>
                <i class="fi-rs-label mr-10"></i>
                <span class="text-muted">Have a coupon?</span>
                <a
                  href="#coupon"
                  data-bs-toggle="collapse"
                  class="collapsed"
                  aria-expanded="false"
                  >Click here to select your coupon</a
                >
              </span>
            </div>

            <div class="panel-collapse collapse coupon_form" id="coupon">
              <div class="panel-body">
                <% if (coupons && coupons.length > 0) { %> <%
                coupons.forEach(coupon => { %>
                <div class="coupon-item mb-15 p-2 border rounded">
                  <p class="mb-1"><strong>Name:</strong> <%= coupon.name %></p>
                  <p class="mb-1"><strong>Code:</strong> <%= coupon.code %></p>
                  <p class="mb-1">
                    <strong>Discount:</strong> <%= coupon.discount %>%
                  </p>
                  <% if ( useCart && useCart.coupon !=null ) { %> <% if
                  (useCart.coupon === coupon.code) { %>
                  <button
                    onclick="removeCoupon('<%= userId %>', '<%= totalPrice %>', '<%= coupon._id %>')"
                    class="btn btn-danger btn-sm mt-2"
                  >
                    Remove Coupon
                  </button>
                  <% } else { %> <% } %> <% } else { %>
                  <button
                    onclick="applyCoupon('<%= userId %>', '<%= totalCartPrice %>' ,'<%= coupon._id %>')"
                    class="btn btn-primary btn-sm mt-2"
                  >
                    Apply Coupon
                  </button>
                  <% } %>
                </div>
                <% }); %> <% } else { %>
                <p>No coupons available</p>
                <% } %>
              </div>
            </div>
          </div>

          <div class="row">
            <div class="col-12">
              <div class="divider mt-50 mb-50"></div>
            </div>
          </div>
          <div class="row">
            <div class="col-md-6">
              <div class="mb-25">
                <h4>Shipping Address</h4>
              </div>

              <style>
                .label {
                  margin-left: 30px;
                }

                .radio-wrapper input[type="radio"] {
                  /* Adjust the size of the radio button */
                  width: 20px;
                  height: 20px;
                  margin-right: 5px;
                  /* Add some spacing between the radio button and the label */
                }
              </style>

              <div class="row mb-25">
                <div class="col">
                  <ul class="list-group">
                    <% for (let i=0; i < userAddress.length; i++) { %>
                    <li class="list-group-item">
                      <div>
                        <span
                          ><strong>Name:</strong>
                          <%= userAddress[i].address.name %>
                        </span>
                      </div>
                      <div>
                        <span
                          ><strong>Mobile:</strong>
                          <%= userAddress[i].address.mobile %>
                        </span>
                      </div>
                      <div>
                        <span
                          ><strong>House:</strong>
                          <%= userAddress[i].address.house %>
                        </span>
                      </div>
                      <div>
                        <span
                          ><strong>City:</strong>
                          <%= userAddress[i].address.city %>
                        </span>
                      </div>
                      <div>
                        <span
                          ><strong>Pincode:</strong>
                          <%= userAddress[i].address.pincode %>
                        </span>
                      </div>
                      <div class="d-flex justify-content-start mt-2">
                        <div class="radio-wrapper">
                          <input
                            type="radio"
                            id="address<%= userAddress[i].address._id %>"
                            name="addressSelected"
                            value="<%= userAddress[i].address._id %>"
                            checked
                          />
                        </div>
                        <label for="address<%= userAddress[i].address._id %>"
                          >Select Address</label
                        >
                        <a
                          href="/editAddress/<%= userAddress[i].address._id %>"
                          class="btn btn-secondary btn-sm ml-15"
                          >Edit Address</a
                        >
                      </div>
                    </li>
                    <% } %>
                  </ul>
                </div>
              </div>

              <!--                                                       
                            <div class="form-group">
                                <div class="checkbox">
                                    <div class="custome-checkbox">
                                        <input class="form-check-input" type="checkbox" name="checkbox" id="createaccount">
                                        <label class="form-check-label label_info" data-bs-toggle="collapse" href="#collapsePassword" data-target="#collapsePassword" aria-controls="collapsePassword" for="createaccount"><span>Create an account?</span></label>
                                    </div>
                                </div>
                            </div> -->
              <form id="formId" action="/addressPost" method="post">
                <div class="ship_detail">
                  <div class="form-group">
                    <div class="chek-form">
                      <div class="custome-checkbox">
                        <!-- <input class="form-check-input" type="checkbox" name="checkbox" id="differentaddress"> -->
                        <label
                          data-bs-toggle="collapse"
                          data-target="#collapseAddress"
                          href="#collapseAddress"
                          aria-controls="collapseAddress"
                          for="differentaddress"
                          ><button class="btn btn-primary">
                            Create New Address
                          </button></label
                        >
                      </div>
                    </div>
                  </div>
                  <div
                    id="collapseAddress"
                    class="different_address collapse in"
                  >
                    <div class="form-group">
                      <input
                        id="name"
                        type="text"
                        required=""
                        name="name"
                        placeholder="Name *"
                      />
                    </div>
                    <p>
                      <span
                        id="error1"
                        style="display: none"
                        class="mt-15 err text-danger"
                      ></span>
                    </p>

                    <div class="form-group">
                      <input
                        id="house"
                        type="text"
                        name="house"
                        required=""
                        placeholder="House *"
                      />
                    </div>
                    <p>
                      <span
                        id="error2"
                        style="display: none"
                        class="mt-15 err text-danger"
                      ></span>
                    </p>

                    <div class="form-group">
                      <input
                        id="city"
                        required=""
                        type="text"
                        name="city"
                        placeholder="City / Town *"
                      />
                    </div>
                    <p>
                      <span
                        id="error3"
                        style="display: none"
                        class="mt-15 err text-danger"
                      ></span>
                    </p>

                    <div class="form-group">
                      <input
                        id="state"
                        required=""
                        type="text"
                        name="state"
                        placeholder="State *"
                      />
                    </div>
                    <p>
                      <span
                        id="error4"
                        style="display: none"
                        class="mt-15 err text-danger"
                      ></span>
                    </p>

                    <div class="form-group">
                      <input
                        id="country"
                        required=""
                        type="text"
                        name="country"
                        placeholder="Country *"
                      />
                    </div>
                    <p>
                      <span
                        id="error5"
                        style="display: none"
                        class="mt-15 err text-danger"
                      ></span>
                    </p>

                    <div class="form-group">
                      <input
                        id="pincode"
                        required=""
                        type="text"
                        name="pincode"
                        placeholder="Pincode *"
                      />
                    </div>
                    <p>
                      <span
                        id="error6"
                        style="display: none"
                        class="mt-15 err text-danger"
                      ></span>
                    </p>

                    <div class="form-group">
                      <input
                        id="mobile"
                        required=""
                        type="text"
                        name="mobile"
                        placeholder="Phone *"
                      />
                    </div>
                    <p>
                      <span
                        id="error7"
                        style="display: none"
                        class="mt-15 err text-danger"
                      ></span>
                    </p>
                    <div>
                      <input
                        type="hidden"
                        name="userId"
                        value="<%= userId %>"
                      />
                    </div>
                    <div>
                      <button type="submit" class="btn btn-primary">
                        Submit
                      </button>
                    </div>
                    <br />
                  </div>
                </div>
              </form>
            </div>
            <script src="/public/formValidation/user/editaddressScript.js"></script>

            <div class="col-md-6">
              <div class="order_review">
                <div class="mb-20">
                  <h4>Your Orders</h4>
                </div>
                <div class="table-responsive order_table text-center">
                  <table class="table">
                    <thead>
                      <tr>
                        <th colspan="2">Product</th>
                        <th>Total</th>
                      </tr>
                    </thead>
                    <tbody>
                      <% cartItems.forEach(cartItem=> { %>
                      <tr>
                        <td class="image product-thumbnail">
                          <img
                            src="/public/uploads/<%= cartItem.productDetails.image[0] %>"
                            alt="<%= cartItem.productDetails.name %>"
                          />
                        </td>
                        <td>
                          <h5>
                            <a href="shop-product-full.html">
                              <%= cartItem.productDetails.name %>
                            </a>
                          </h5>
                          <span class="product-qty">
                            <%= cartItem.items ? cartItem.items.quantity : 0 %>
                          </span>
                        </td>
                        <td>₹ <%= cartItem.subtotal %></td>
                      </tr>
                      <% }) %>

                      <!-- Subtotal Row -->
                      <tr>
                        <th>SubTotal</th>
                        <td class="product-subtotal" colspan="2">
                          ₹ <%= totalCartPrice %>
                        </td>
                      </tr>

                      <!-- Coupon Details Row (Show only if coupon is applied) -->
                      <% if(useCart && useCart.coupon != null) { %>
                      <tr class="coupon-row" style="background-color: #f8f9fa">
                        <th style="color: #28a745">
                          <i class="fas fa-tag"></i> Coupon Applied
                        </th>
                        <td colspan="2" style="color: #28a745">
                          <strong><%= useCart.coupon %></strong>
                          <br />
                          <small class="text-muted"
                            >You saved ₹<%= useCart.discountAmount ||
                            (totalCartPrice - totalPrice) %></small
                          >
                        </td>
                      </tr>
                      <tr>
                        <th style="color: #dc3545">Discount</th>
                        <td colspan="2" style="color: #dc3545">
                          -₹ <%= useCart.discountAmount || (totalCartPrice -
                          totalPrice) %>
                        </td>
                      </tr>
                      <% } %>

                      <!-- Shipping Row -->
                      <tr>
                        <th>Shipping</th>
                        <td colspan="2"><em>Free Shipping</em></td>
                      </tr>

                      <!-- Total Row -->
                      <tr style="border-top: 2px solid #dee2e6">
                        <th style="font-size: 18px">Total</th>
                        <td colspan="2" class="product-subtotal">
                          <span
                            id="totalAmount"
                            class="font-xl text-brand fw-900"
                            style="font-size: 20px"
                          >
                            ₹ <% if(useCart && useCart.coupon != null) { %> <%=
                            totalPrice %> <% } else { %> <%= totalCartPrice %>
                            <% } %>
                          </span>
                          <% if(useCart && useCart.coupon != null) { %>
                          <br />
                          <small
                            class="text-muted"
                            style="text-decoration: line-through"
                          >
                            Original: ₹<%= totalCartPrice %>
                          </small>
                          <% } %>
                        </td>
                      </tr>
                    </tbody>
                  </table>
                </div>

                <!-- Optional: Coupon Summary Card (if you want more detailed display) -->
                <% if(useCart && useCart.coupon != null) { %>
                <div class="alert alert-success mt-3" role="alert">
                  <div
                    class="d-flex justify-content-between align-items-center"
                  >
                    <div>
                      <i class="fas fa-check-circle me-2"></i>
                      <strong
                        >Coupon "<%= useCart.coupon %>" Applied
                        Successfully!</strong
                      >
                    </div>
                    <div class="text-end">
                      <small class="d-block">You saved</small>
                      <strong class="text-success"
                        >₹<%= useCart.discountAmount || (totalCartPrice -
                        totalPrice) %></strong
                      >
                    </div>
                  </div>
                </div>
                <% } %>

                <div class="bt-1 border-color-1 mt-30 mb-30"></div>
                <div class="payment_method">
                  <div class="mb-25">
                    <h5>Payment</h5>
                  </div>
                  <div class="payment_option">
                    <div class="custome-radio">
                      <input
                        value="Wallet"
                        class="form-check-input"
                        required=""
                        type="radio"
                        name="payment_option"
                        id="exampleRadios3"
                        checked=""
                      />
                      <label
                        class="form-check-label"
                        for="exampleRadios3"
                        data-bs-toggle="collapse"
                        data-target="#bankTranfer"
                        aria-controls="bankTranfer"
                        >Wallet
                      </label>
                      <div class="form-group collapse in" id="bankTranfer">
                        <p class="text-muted mt-5">
                          There are many variations of passages of Lorem Ipsum
                          available, but the majority have suffered alteration.
                        </p>
                      </div>
                    </div>
                    <div class="custome-radio">
                      <input
                        value="COD"
                        class="form-check-input"
                        required=""
                        type="radio"
                        name="payment_option"
                        id="exampleRadios4"
                        checked=""
                      />
                      <label
                        value
                        class="form-check-label"
                        for="exampleRadios4"
                        data-bs-toggle="collapse"
                        data-target="#checkPayment"
                        aria-controls="checkPayment"
                        >Cash on delivery
                      </label>
                      <div class="form-group collapse in" id="checkPayment">
                        <p class="text-muted mt-5">
                          Please send your cheque to Store Name, Store Street,
                          Store Town, Store State / County, Store Postcode.
                        </p>
                      </div>
                    </div>
                    <div class="custome-radio">
                      <input
                        value="Razorpay"
                        class="form-check-input"
                        required=""
                        type="radio"
                        name="payment_option"
                        id="exampleRadios5"
                        checked=""
                      />
                      <label
                        class="form-check-label"
                        for="exampleRadios5"
                        data-bs-toggle="collapse"
                        data-target="#Razorpay"
                        aria-controls="Razorpay"
                        >Razorpay</label
                      >
                      <div class="form-group collapse in" id="paypal">
                        <p class="text-muted mt-5">
                          Pay via PayPal; you can pay with your credit card if
                          you don't have a PayPal account.
                        </p>
                      </div>
                    </div>
                  </div>
                </div>
                <% if (userInfo.address.length === 0) { %>
                <p>Create an address</p>
                <% } else { %>
                <button
                  class="btn btn-fill-out btn-block mt-30"
                  id="placeOrderButton"
                >
                  Place Order
                </button>
                <% } %>
              </div>
            </div>
          </div>
        </div>
      </section>
    </main>
    <footer class="main">
      <section class="newsletter p-30 text-white wow fadeIn animated">
        <div class="container">
          <div class="row align-items-center">
            <div class="col-lg-7 mb-md-3 mb-lg-0">
              <div class="row align-items-center">
                <div class="col flex-horizontal-center">
                  <img
                    class="icon-email"
                    src="assets/imgs/theme/icons/icon-email.svg"
                    alt=""
                  />
                  <h4 class="font-size-20 mb-0 ml-3">Sign up to Newsletter</h4>
                </div>
                <div class="col my-4 my-md-0 des">
                  <h5 class="font-size-15 ml-4 mb-0">
                    ...and receive
                    <strong>$25 coupon for first shopping.</strong>
                  </h5>
                </div>
              </div>
            </div>
            <div class="col-lg-5">
              <!-- Subscribe Form -->
              <form class="form-subcriber d-flex wow fadeIn animated">
                <input
                  type="email"
                  class="form-control bg-white font-small"
                  placeholder="Enter your email"
                />
                <button class="btn bg-dark text-white" type="submit">
                  Subscribe
                </button>
              </form>
              <!-- End Subscribe Form -->
            </div>
          </div>
        </div>
      </section>
      <section class="section-padding footer-mid">
        <div class="container pt-15 pb-20">
          <div class="row">
            <div class="col-lg-4 col-md-6">
              <div class="widget-about font-md mb-md-5 mb-lg-0">
                <div class="logo logo-width-1 wow fadeIn animated">
                  <a href="#"
                    ><img
                      src="/public/assets/imgs/theme/Tonehive (1).png"
                      alt="logo"
                  /></a>
                </div>
                <h5 class="mt-20 mb-10 fw-600 text-grey-4 wow fadeIn animated">
                  Contact
                </h5>
                <p class="wow fadeIn animated">
                  <strong>Address: </strong>562 Wellington Road, Street 32, San
                  Francisco
                </p>
                <p class="wow fadeIn animated">
                  <strong>Phone: </strong>+01 2222 365 /(+91) 01 2345 6789
                </p>
                <p class="wow fadeIn animated">
                  <strong>Hours: </strong>10:00 - 18:00, Mon - Sat
                </p>
                <h5 class="mb-10 mt-30 fw-600 text-grey-4 wow fadeIn animated">
                  Follow Us
                </h5>
                <div
                  class="mobile-social-icon wow fadeIn animated mb-sm-5 mb-md-0"
                >
                  <a href="#"
                    ><img
                      src="assets/imgs/theme/icons/icon-facebook.svg"
                      alt=""
                  /></a>
                  <a href="#"
                    ><img src="assets/imgs/theme/icons/icon-twitter.svg" alt=""
                  /></a>
                  <a href="#"
                    ><img
                      src="assets/imgs/theme/icons/icon-instagram.svg"
                      alt=""
                  /></a>
                  <a href="#"
                    ><img
                      src="assets/imgs/theme/icons/icon-pinterest.svg"
                      alt=""
                  /></a>
                  <a href="#"
                    ><img src="assets/imgs/theme/icons/icon-youtube.svg" alt=""
                  /></a>
                </div>
              </div>
            </div>
            <div class="col-lg-2 col-md-3">
              <h5 class="widget-title wow fadeIn animated">About</h5>
              <ul class="footer-list wow fadeIn animated mb-sm-5 mb-md-0">
                <li><a href="#">About Us</a></li>
                <li><a href="#">Delivery Information</a></li>
                <li><a href="#">Privacy Policy</a></li>
                <li><a href="#">Terms &amp; Conditions</a></li>
                <li><a href="#">Contact Us</a></li>
                <li><a href="#">Support Center</a></li>
              </ul>
            </div>
            <div class="col-lg-2 col-md-3">
              <h5 class="widget-title wow fadeIn animated">My Account</h5>
              <ul class="footer-list wow fadeIn animated">
                <li><a href="#">Sign In</a></li>
                <li><a href="#">View Cart</a></li>
                <li><a href="#">My Wishlist</a></li>
                <li><a href="#">Track My Order</a></li>
                <li><a href="#">Help</a></li>
                <li><a href="#">Order</a></li>
              </ul>
            </div>
            <div class="col-lg-4">
              <h5 class="widget-title wow fadeIn animated">Install App</h5>
              <div class="row">
                <div class="col-md-8 col-lg-12">
                  <p class="wow fadeIn animated">
                    From App Store or Google Play
                  </p>
                  <div class="download-app wow fadeIn animated">
                    <a href="#" class="hover-up mb-sm-4 mb-lg-0"
                      ><img
                        class="active"
                        src="assets/imgs/theme/app-store.jpg"
                        alt=""
                    /></a>
                    <a href="#" class="hover-up"
                      ><img src="assets/imgs/theme/google-play.jpg" alt=""
                    /></a>
                  </div>
                </div>
                <div class="col-md-4 col-lg-12 mt-md-3 mt-lg-0">
                  <p class="mb-20 wow fadeIn animated">
                    Secured Payment Gateways
                  </p>
                  <img
                    class="wow fadeIn animated"
                    src="assets/imgs/theme/payment-method.png"
                    alt=""
                  />
                </div>
              </div>
            </div>
          </div>
        </div>
      </section>
      <div class="container pb-20 wow fadeIn animated">
        <div class="row">
          <div class="col-12 mb-20">
            <div class="footer-bottom"></div>
          </div>
          <div class="col-lg-6">
            <p class="float-md-left font-sm text-muted mb-0">
              &copy; 2022, <strong class="text-brand">Evara</strong> - HTML
              Ecommerce Template
            </p>
          </div>
          <div class="col-lg-6">
            <p class="text-lg-end text-start font-sm text-muted mb-0">
              Designed by
              <a href="http://alithemes.com/" target="_blank">Alithemes.com</a>.
              All rights reserved
            </p>
          </div>
        </div>
      </div>
    </footer>
    <!-- Preloader Start -->
    <div id="preloader-active">
      <div class="preloader d-flex align-items-center justify-content-center">
        <div class="preloader-inner position-relative">
          <div class="text-center">
            <h5 class="mb-5">Now Loading</h5>
            <div class="loader">
              <div class="bar bar1"></div>
              <div class="bar bar2"></div>
              <div class="bar bar3"></div>
            </div>
          </div>
        </div>
      </div>
    </div>
    <!-- Vendor JS-->
    <script src="assets/js/vendor/modernizr-3.6.0.min.js"></script>
    <script src="assets/js/vendor/jquery-3.6.0.min.js"></script>
    <script src="assets/js/vendor/jquery-migrate-3.3.0.min.js"></script>
    <script src="assets/js/vendor/bootstrap.bundle.min.js"></script>
    <script src="assets/js/plugins/slick.js"></script>
    <script src="assets/js/plugins/jquery.syotimer.min.js"></script>
    <script src="assets/js/plugins/wow.js"></script>
    <script src="assets/js/plugins/jquery-ui.js"></script>
    <script src="assets/js/plugins/perfect-scrollbar.js"></script>
    <script src="assets/js/plugins/magnific-popup.js"></script>
    <script src="assets/js/plugins/select2.min.js"></script>
    <script src="assets/js/plugins/waypoints.js"></script>
    <script src="assets/js/plugins/counterup.js"></script>
    <script src="assets/js/plugins/jquery.countdown.min.js"></script>
    <script src="assets/js/plugins/images-loaded.js"></script>
    <script src="assets/js/plugins/isotope.js"></script>
    <script src="assets/js/plugins/scrollup.js"></script>
    <script src="assets/js/plugins/jquery.vticker-min.js"></script>
    <!-- Template  JS -->
    <script src="assets/js/maind134.js?v=3.4"></script>
    <script src="assets/js/shopd134.js?v=3.4"></script>
    <script src="https://cdn.jsdelivr.net/npm/sweetalert2@10"></script>
    <link
      rel="stylesheet"
      href="https://cdn.jsdelivr.net/npm/toastify-js/src/toastify.min.css"
    />
    <script src="https://cdn.jsdelivr.net/npm/toastify-js"></script>
  </body>

  <!-- Mirrored from wp.alithemes.com/html/evara/evara-frontend/shop-checkout.html by HTTrack Website Copier/3.x [XR&CO'2014], Sat, 15 Jul 2023 10:10:07 GMT -->
</html>

<script>
  function deleteAddress(userId) {
    Swal.fire("Do you want to delete address", {
      buttons: ["No", "yes"],
    }).then((res) => {
      if (res.isConfirmed) {
        $.ajax({
          url: "/deleteAddress/" + userId,
          method: "DELETE",
        })
          .done((res) => {
            Swal.fire("Successful", `${res.message}`, "success").then(() => {
              setTimeout(() => {
                window.location.reload();
              }, 1000);
            });
          })
          .fail((error) => {
            console.log(error);
          });
      }
    });
  }
</script>

<script>
  document
    .getElementById("placeOrderButton")
    .addEventListener("click", function () {
      const selectedAddress = document.querySelector(
        'input[name="addressSelected"]:checked'
      ).value;
      console.log(selectedAddress);

      const selectedPaymentMethod = document.querySelector(
        'input[name="payment_option"]:checked'
      ).value;

      const totalAmount = document.getElementById("totalAmount");
      let totalPrice = totalAmount.textContent.trim(); // remove leading/trailing whitespace
      totalPrice = totalPrice.replace(/[^\d]/g, ""); // remove everything except digits
      // console.log('totalPrice', totalPrice);

      const data = {
        address: selectedAddress,
        paymentMethod: selectedPaymentMethod,
      };

      if (selectedPaymentMethod === "Razorpay") {
        fetch("/createorder", {
          method: "post",
          headers: {
            "Content-Type": "application/json",
          },
          body: JSON.stringify({ totalPrice }),
        })
          .then((response) => response.json())
          .then((data) => {
            const parseAmount = parseInt(totalPrice);
            var options = {
              key: "rzp_test_Bimw1kt6COUeba",
              amount: 100000,
              currency: "INR",
              name: "Tone Hive",
              description: "Test Transaction",
              image:
                "http://localhost:3000/public/assets/imgs/theme/Tonehive%20(1).png",
              order_id: data.orderId.id,
              handler: function (response) {
                console.log(response);
                verify(
                  response,
                  data.orderId.id,
                  selectedAddress,
                  selectedPaymentMethod
                );
              },
              prefill: {
                name: "Gaurav Kumar",
                email: "gaurav.kumar@example.com",
                contact: "9000090000",
              },
              notes: {
                address: "Razorpay Corporate Office",
              },
              theme: {
                color: "#3399cc",
              },
            };

            var rzp = new Razorpay(options);
            rzp.open();
            rzp.on("payment.failed", function (response) {
              console.log("Payment failed:", response.error.description);
              handleFailure(
                response.error.description,
                selectedAddress,
                selectedPaymentMethod
              );
            });

            function verify(response, orderId, address, paymentMethod) {
              console.log("heeeee", response, orderId);
              fetch("/paymentSuccess", {
                method: "post",
                headers: {
                  "Content-Type": "application/json",
                },
                body: JSON.stringify({
                  paymentid: response.razorpay_payment_id,
                  razorpayorderid: response.razorpay_order_id,
                  signature: response.razorpay_signature,
                  orderId: orderId,
                  address: address,
                  paymentMethod: paymentMethod,
                }),
              })
                .then((response) => response.json())
                .then((data) => {
                  if (data.success) {
                    // Payment successful, create order
                    fetch("/placeOrder", {
                      method: "POST",
                      headers: {
                        "Content-Type": "application/json",
                      },
                      body: JSON.stringify({
                        address: selectedAddress,
                        paymentMethod: selectedPaymentMethod,
                      }),
                    })
                      .then((response) => response.json())
                      .then((data) => {
                        console.log(data);
                        window.location.href = "/orderSuccess";
                      })
                      .catch((error) => {
                        console.error("Error:", error);
                      });
                  } else {
                    // Payment failed, create order anyway with status 'payment pending'
                    createOrderWithStatusPending(
                      selectedAddress,
                      selectedPaymentMethod
                    );
                  }
                })
                .catch((error) => {
                  // Handle any errors that occur during the fetch operation
                  console.error("Error:", error);
                });
            }
          });
      } else if (selectedPaymentMethod === "COD") {
        fetch("/placeOrder", {
          method: "POST",
          headers: {
            "Content-Type": "application/json",
          },
          body: JSON.stringify(data),
        })
          .then((response) => response.json())
          .then((data) => {
            if (data.error) {
              Swal.fire({
                icon: "error",
                title: "Oops...",
                text: "COD is not allowed for orders greater than 1000 rupees.",
              });
            } else {
              window.location.href = "/orderSuccess";
            }
          })
          .catch((error) => {
            console.log("dddd");
            console.error("Error:", error);
          });
      }
    });

  function watchPaymentMethod() {
    let previousPaymentMethod = null;

    setInterval(function () {
      const selectedPaymentMethod = document.querySelector(
        'input[name="payment_option"]:checked'
      ).value;

      if (selectedPaymentMethod !== previousPaymentMethod) {
        console.log("Selected Payment Method:", selectedPaymentMethod);

        previousPaymentMethod = selectedPaymentMethod;
      }
    }, 100);
  }

  watchPaymentMethod();

  function handleFailure(description, selectedAddress, selectedPaymentMethod) {
    console.log("Payment failed:", description);

    // Redirect to appropriate page or handle as required
    createOrderWithStatusPending(selectedAddress, selectedPaymentMethod);
  }

  function createOrderWithStatusPending(address, paymentMethod) {
    fetch("/placeOrder", {
      method: "POST",
      headers: {
        "Content-Type": "application/json",
      },
      body: JSON.stringify({
        address: address,
        paymentMethod: paymentMethod,
        status: "payment pending",
      }),
    })
      .then((response) => {
        if (!response.ok) {
          throw new Error("Failed to create order.");
        }
        return response.json();
      })
      .then((data) => {
        console.log(data);
        if (data.success) {
          // Redirect to the appropriate page with the newly created order ID
          window.location.href = `/orderFailed`;
        } else {
          console.error("Error: Order creation failed");
          // Handle the error case where order creation fails
          // You may redirect to an error page or display a message to the user
        }
      })
      .catch((error) => {
        console.error("Error:", error);
        // Handle any errors that occur during the fetch operation
        // You may redirect to an error page or display a message to the user
      });
  }
</script>

<script>
  function applyCoupon(userId, totalCartPrice, couponId) {
    // if (!couponCode) {
    //     couponCode = document.getElementById('couponCode')?.value;
    // }

    console.log("ljlk123jl", userId, totalCartPrice, couponId);

    // if (!couponCode) {
    //     Toastify({
    //         text: "Please enter a valid coupon code.",
    //         duration: 5000,
    //         gravity: "top",
    //         position: "center",
    //         backgroundColor: "#ff3333",
    //         stopOnFocus: true
    //     }).showToast();
    //     return;
    // }

    $.ajax({
      url: "/applyCoupon",
      type: "post",
      data: { usedBy: userId, totalCartPrice: totalCartPrice, couponId },
      success: function (res) {
        if (res.message) {
          Toastify({
            text: res.message,
            duration: 5000,
            gravity: "top",
            position: "center",
            backgroundColor: "#ff3333",
            stopOnFocus: true,
          }).showToast();
        }
        if (res.success) {
          Toastify({
            text: res.success,
            duration: 5000,
            gravity: "top",
            position: "center",
            backgroundColor: "#5cb85c",
            stopOnFocus: true,
          }).showToast();
          setTimeout(() => {
            window.location.reload();
          }, 1000);
        }
      },
    });
  }
</script>

<script>
  function removeCoupon(userId, totalPrice, couponId) {
    console.log("ljlkjl", userId, totalPrice, couponId);

    fetch(`/removeCoupon/${userId}/${totalPrice}`, { method: "PATCH" }).then(
      (res) => {
        if (res.ok) {
          Swal.fire({
            icon: "success",
            title: "Coupon Removed",
            text: "The coupon has been successfully removed.",
            showConfirmButton: false,
            timer: 1500,
          }).then(() => {
            window.location.reload();
          });
        } else {
          Swal.fire({
            icon: "error",
            title: "Oops...",
            text: "Failed to remove the coupon.",
            showConfirmButton: false,
            timer: 1500,
          });
        }
      }
    );
  }
</script>
